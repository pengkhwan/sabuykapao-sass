---
// src/pages/portfolio/index.astro
import Layout from '../../layouts/Layout.astro';
import '../../styles/pages/_portfolio.scss';
import { client } from '../../sanity.js';

// แก้ไข Query: เพิ่ม "alt": mainImage.alt สำหรับรูปใน gallery ด้วย
const query = `*[_type == "portfolio"] | order(_createdAt desc) {
  title,
  description,
  "imageUrl": mainImage.asset->url,
  "alt": mainImage.alt,
  "gallery": gallery[]{
    "url": asset->url,
    "alt": alt
  }
}`;

const portfolioItems = await client.fetch(query);

const pageSchema = {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "รับทำของชำร่วยเครื่องหนัง ของที่ระลึกพรีเมียม สลักชื่อได้ | sabuykapao",
    "description": "รับสั่งทำของชำร่วยเครื่องหนัง ของที่ระลึกเกรดพรีเมียมสำหรับทุกโอกาสสำคัญ ทั้งงานแต่ง งานเกษียณ งานบวช ออกแบบและสลักชื่อ/โลโก้ได้ในราคาโรงงาน",
    "url": new URL(Astro.url.pathname, Astro.site).href,
};
---

<Layout 
  title="รับทำของชำร่วยเครื่องหนัง ของที่ระลึกพรีเมียม สลักชื่อได้ | sabuykapao"
  description="รับสั่งทำของชำร่วยเครื่องหนัง ของที่ระลึกเกรดพรีเมียมสำหรับทุกโอกาสสำคัญ ทั้งงานแต่ง งานเกษียณ งานบวช ออกแบบและสลักชื่อ/โลโก้ได้ในราคาโรงงาน"
>
  <Fragment slot="head">
    <script type="application/ld+json" set:html={JSON.stringify(pageSchema)} />
  </Fragment>

  <main class="portfolio-page">
    <div class="container">
      <div class="page-header">
        <h1>ของชำร่วยเครื่องหนัง สั่งทำพิเศษ</h1>
        <p>
          มอบความทรงจำอันล้ำค่าผ่านของชำร่วยเครื่องหนังเกรดพรีเมียม ที่เราบรรจงสร้างสรรค์ด้วยความประณีตทุกขั้นตอน พร้อมบริการสั่งทำพิเศษเพื่อสะท้อนตัวตนของคุณและวันสำคัญได้อย่างสมบูรณ์แบบ ไม่ว่าจะเป็นของชำร่วยงานแต่ง, ของที่ระลึกงานบวช, งานเกษียณ, หรืองานมิตติ้ง เราสามารถสลักโลโก้และออกแบบให้ตอบโจทย์ความต้องการของคุณได้ทั้งหมด
        </p>
      </div>

      <div class="portfolio-grid-container">
        <div class="portfolio-grid">
          {portfolioItems.map((item) => (
            <div class="portfolio-card">
              <div class="portfolio-card__image-wrapper">
                {item.imageUrl && (
                  <img 
                    src={`${item.imageUrl}?w=600&h=600&fit=crop&auto=format`}
                    alt={item.alt || item.title}
                    width="600"
                    height="600"
                    loading="lazy"
                    decoding="async"
                  />
                )}
              </div>
              <h2 class="portfolio-card__name">{item.title}</h2>
              {item.description && <p class="portfolio-card__description">{item.description}</p>}
            </div>
          ))}
        </div>
      </div>

      <div class="contact-prompt">
        <h3>สนใจสั่งทำชิ้นงานพิเศษของคุณเอง?</h3>
        <p>สัมผัสประสบการณ์งานสั่งทำคุณภาพส่งออก ในราคาผู้ผลิตโดยตรง ที่จะทำให้แขกคนสำคัญของคุณประทับใจไม่รู้ลืม</p>
        <div class="contact-buttons">
          <a href="#" class="contact-button line">
            <img src="/icons/icon-line-white.svg" alt="" width="24" height="24"/>
            <span>สอบถามทาง Line</span>
          </a>
          <a href="#" class="contact-button facebook">
            <img src="/icons/icon-facebook-messenger-white.svg" alt="" width="24" height="24"/>
            <span>ส่งข้อความ Facebook</span>
          </a>
        </div>
      </div>
    </div>
  </main>
</Layout>